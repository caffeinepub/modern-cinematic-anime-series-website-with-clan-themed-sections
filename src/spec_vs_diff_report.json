{
  "kind": "spec_vs_diff_report",
  "version": "1.0",
  "generatedAt": "2026-02-13T14:45:37.888Z",
  "summary": "Backend and admin panel were extended with new episode fields, migration support, image upload validation, and UI state for sorting/reordering. However, the diff shows mismatches with the required field/value names (runtimeMinutes vs runtime; Public vs publicVisibility), and the React Query mutations do not appear to send/persist an explicit order field. Additionally, many unrelated marketing-site UI/style changes were made that were not requested.",
  "missing_requirements": [
    {
      "id": "REQ-63",
      "requirement": "Visibility status must support exactly these values: Draft, Scheduled, Public (and be persisted/returned consistently).",
      "reason": "The backend visibility variant is implemented as #publicVisibility (and frontend uses 'publicVisibility'), not 'Public' as required, indicating the value set does not match the exact required enum values.",
      "evidence": [
        "backend/main.mo",
        "backend/migration.mo",
        "frontend/src/components/admin/panels/EpisodesAdminPanel.tsx",
        "frontend/src/hooks/useQueries.ts"
      ]
    },
    {
      "id": "REQ-63",
      "requirement": "Episode data model/API must use runtimeMinutes (in minutes) as an admin-managed field.",
      "reason": "The schema uses a field named runtime (type ?Nat) rather than runtimeMinutes, so the required field name is not implemented as specified.",
      "evidence": [
        "backend/main.mo",
        "backend/migration.mo",
        "frontend/src/hooks/useQueries.ts",
        "frontend/src/components/admin/panels/EpisodesAdminPanel.tsx"
      ]
    },
    {
      "id": "REQ-63",
      "requirement": "Create and update APIs accept and persist the explicit sortable order field used for episode reordering.",
      "reason": "The frontend create mutation payload and actor.createEpisode call do not include an order parameter, so the admin cannot explicitly set/persist the order field via create/update as required (only sorting by order is shown in the UI).",
      "evidence": [
        "frontend/src/hooks/useQueries.ts",
        "frontend/src/components/admin/panels/EpisodesAdminPanel.tsx"
      ]
    },
    {
      "id": "REQ-65",
      "requirement": "useCreateEpisode and useUpdateEpisode accept and pass through the new episode fields including order.",
      "reason": "useCreateEpisodeâ€™s mutationFn does not include/order pass an order field to actor.createEpisode; therefore the hook does not pass through all required new fields.",
      "evidence": [
        "frontend/src/hooks/useQueries.ts"
      ]
    }
  ],
  "hallucinated_features": [
    {
      "description": "Large-scale redesign/enhancement of global marketing-site styling and animations (e.g., 'dramatic anime aesthetic', world-map-hotspot utility classes, new keyframes, cinematic tokens).",
      "reason": "Not requested by the BuildRequest, which is focused on the Episodes admin panel enhancements and backend episode fields.",
      "evidence": [
        "frontend-file-summaries.txt (frontend/src/index.css)",
        "frontend-file-summaries.txt (frontend/tailwind.config.js)"
      ]
    },
    {
      "description": "Hash-based routing changes and navigation/admin-link behavior changes in the main app and header.",
      "reason": "Not requested; BuildRequest does not ask for routing or navigation changes.",
      "evidence": [
        "frontend-file-summaries.txt (frontend/src/App.tsx)",
        "frontend-file-summaries.txt (frontend/src/components/sections/HeaderNav.tsx)"
      ]
    },
    {
      "description": "Multiple marketing section content/layout changes (Hero/About/Clans/Footer/ClanCard/ClanBadge/CharactersSection), including lore text edits and integrated WorldMapSection.",
      "reason": "Not requested; outside Episodes admin panel scope.",
      "evidence": [
        "frontend-file-summaries.txt (frontend/src/components/sections/HeroSection.tsx)",
        "frontend-file-summaries.txt (frontend/src/components/sections/AboutSection.tsx)",
        "frontend-file-summaries.txt (frontend/src/components/sections/ClansSection.tsx)",
        "frontend-file-summaries.txt (frontend/src/components/sections/Footer.tsx)",
        "frontend-file-summaries.txt (frontend/src/components/clans/ClanCard.tsx)",
        "frontend-file-summaries.txt (frontend/src/components/clans/ClanBadge.tsx)",
        "frontend-file-summaries.txt (frontend/src/components/sections/CharactersSection.tsx)",
        "frontend-file-summaries.txt (frontend/src/data/clans.ts)"
      ]
    },
    {
      "description": "New general-purpose animation/parallax hooks (usePrefersReducedMotion/useRevealOnScroll/useParallax).",
      "reason": "Not requested by this Episodes admin panel enhancement request.",
      "evidence": [
        "frontend-file-summaries.txt (frontend/src/hooks/usePrefersReducedMotion.ts)",
        "frontend-file-summaries.txt (frontend/src/hooks/useRevealOnScroll.ts)",
        "frontend-file-summaries.txt (frontend/src/hooks/useParallax.ts)"
      ]
    }
  ],
  "confidence": 0.72,
  "changed_files": [
    "backend/main.mo",
    "backend/migration.mo",
    "frontend-file-summaries.txt",
    "frontend/src/components/admin/panels/EpisodesAdminPanel.tsx",
    "frontend/src/hooks/useQueries.ts",
    "frontend/src/utils/galleryImageUpload.ts",
    "project_state.json"
  ]
}